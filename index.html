<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Alcoolimpiadi</title>
  <style>
    :root {
      --primary: #2c3e50;
      --secondary: #3498db;
    }
    body {
      font-family: 'Arial', sans-serif;
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
      background: #f8f9fa;
    }
    .header {
      text-align: center;
      padding: 2rem;
      background: var(--primary);
      color: white;
      border-radius: 10px;
      margin-bottom: 2rem;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 2rem;
    }
    .card {
      background: white;
      padding: 1.5rem;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      margin-bottom: 2rem;
    }
    .team-management {
      margin-bottom: 2rem;
    }
    input,
    select,
    button {
      padding: 0.8rem;
      margin: 0.5rem 0;
      border: 1px solid #ddd;
      border-radius: 5px;
      width: 100%;
    }
    button {
      background: var(--secondary);
      color: white;
      border: none;
      cursor: pointer;
      transition: opacity 0.3s;
    }
    button:hover {
      opacity: 0.9;
    }
    .medal {
      display: inline-block;
      width: 25px;
      height: 25px;
      border-radius: 50%;
      text-align: center;
      line-height: 25px;
      font-size: 0.8rem;
      margin: 0 2px;
    }
    .gold {
      background: #ffd700;
    }
    .silver {
      background: #c0c0c0;
    }
    .bronze {
      background: #cd7f32;
    }
    .discipline {
      margin: 1rem 0;
      padding: 1rem;
      border: 1px solid #eee;
      border-radius: 5px;
    }
    .rules-section {
      padding: 1rem;
      background: #fff;
      margin: 1rem 0;
    }
    .tabs {
      margin-bottom: 1rem;
    }
    .tabs button {
      margin: 0.5rem;
      padding: 0.5rem 1rem;
      border: none;
      background: var(--secondary);
      color: white;
      cursor: pointer;
      border-radius: 5px;
    }
    .day-content {
      display: none;
    }
    .game {
      margin-bottom: 1rem;
      padding: 1rem;
      border: 1px solid #eee;
      border-radius: 5px;
    }
    .game h3 {
      margin-top: 0;
    }
    .game-rules {
      margin-top: 0.5rem;
      padding: 0.5rem;
      background: #f0f0f0;
      border-left: 3px solid var(--secondary);
      display: block;
    }
    #leaderboard {
      width: 100%;
      border-collapse: collapse;
    }
    #leaderboard th,
    #leaderboard td {
      padding: 10px;
      text-align: center;
      border: 1px solid #ddd;
    }
  </style>
  
  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore-compat.js"></script>
</head>
<body>
  <div class="header">
    <h1>üçª BENVENUTI ALLE ALCOOLIMPIADI ü•á</h1>
    <p></p>
  </div>

  <div class="grid">
    <!-- Team Management -->
    <div class="card">
      <h2>Gestione Squadre</h2>
      <div class="team-management">
        <input type="text" id="teamName" placeholder="Inserire nome squadra" />
        <button onclick="addTeam()">Aggiungere Nuova Squadra</button>
      </div>
    </div>

    <!-- Rules -->
    <div class="card">
      <h2>Regolamento</h2>
      <div id="generalRule" class="rules-section active-rule">
        <h3>Regole generali</h3>
        <ul>
          <li>4 partecipanti per squadra</li>
          <li>9 discipline</li>
          <li>Infinito divertimento</li>
        </ul>
      </div>
      <div id="alcoholRule" class="rules-section">
        <h3>Regole alcoliche</h3>
        <ul>
          <li>1 shot = ¬Ω bicchiere di vino = 1 birra</li>
          <li>Va finito completamente</li>
          <li>Il valore degli shot dipende dalla gara</li>
        </ul>
      </div>
      <div id="scoringRule" class="rules-section">
        <h3>Punteggi</h3>
        <ul>
          <li>Oro ü•á: 4 punti</li>
          <li>Argento ü•à: 2 punti</li>
          <li>Bronzo ü•â: 1 punto</li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Calendar -->
  <div class="card">
    <h2>Calendario gare</h2>
    <div class="tabs">
      <button onclick="showDay('day1')">Giorno 1</button>
      <button onclick="showDay('day2')">Giorno 2</button>
    </div>
    <!-- Day 1 Content (same as original) -->
    <!-- Day 2 Content (same as original) -->
  </div>

  <!-- Results -->
  <div class="card">
    <h2>Risultati</h2>
    <div id="disciplinesContainer"></div>
  </div>

  <!-- Leaderboard -->
  <div class="card">
    <h2>Classifica Live</h2>
    <table id="leaderboard">
      <thead>
        <tr>
          <th>Squadra</th>
          <th>Punti</th>
          <th>Oro</th>
          <th>Argento</th>
          <th>Bronzo</th>
        </tr>
      </thead>
      <tbody id="leaderboardBody"></tbody>
    </table>
  </div>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyDlPu81AaDsPaXGpOBM2q7AicE9Zb5CULE",
      authDomain: "olimpiadi-bb316.firebaseapp.com",
      projectId: "olimpiadi-bb316",
      storageBucket: "olimpiadi-bb316.firebasestorage.app",
      messagingSenderId: "294002399950",
      appId: "1:294002399950:web:c1e6acc74b7f849ab00e9f",
      measurementId: "G-ELHHLVK9X8"
    };

    // Initialize Firebase
    const app = firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    const dataRef = db.collection("games").doc("alcoolimpiadi");

    let teams = [];
    let disciplines = {};
    const disciplineList = [/* same as original */];

    // Real-time listener
    dataRef.onSnapshot((doc) => {
      if (doc.exists) {
        const data = doc.data();
        teams = data.teams || [];
        disciplines = data.disciplines || {};
        renderDisciplines();
        updateLeaderboard();
      }
    });

    async function initializeApp() {
      const doc = await dataRef.get();
      if (!doc.exists) {
        disciplineList.forEach(d => disciplines[d] = { gold: null, silver: null, bronze: null });
        await dataRef.set({ teams: [], disciplines });
      }
    }

    async function addTeam() {
      const teamName = document.getElementById('teamName').value.trim();
      if (!teamName) return;
      
      if (teams.some(t => t.name.toLowerCase() === teamName.toLowerCase())) {
        alert('Nome squadra gi√† esistente!');
        return;
      }
      
      teams.push({ name: teamName, gold: 0, silver: 0, bronze: 0, points: 0 });
      await dataRef.update({ teams });
      document.getElementById('teamName').value = '';
    }

    async function updateMedal(discipline, medalType, teamName) {
      // Update logic (same as previous version)
      // ...
      await dataRef.update({ disciplines, teams });
    }

    // Keep all other original functions unchanged
    function renderDisciplines() { /* ... */ }
    function updateLeaderboard() { /* ... */ }
    function showDay(day) { /* ... */ }

    // Start app
    initializeApp();
  </script>
</body>
</html>